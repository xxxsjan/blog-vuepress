<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React | web-note</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="Hello!">
    
    <link rel="preload" href="/assets/css/0.styles.495d9abf.css" as="style"><link rel="preload" href="/assets/js/app.7e40d91d.js" as="script"><link rel="preload" href="/assets/js/2.74dbbd17.js" as="script"><link rel="preload" href="/assets/js/32.557433ae.js" as="script"><link rel="prefetch" href="/assets/js/10.77e92b90.js"><link rel="prefetch" href="/assets/js/11.3a155bc5.js"><link rel="prefetch" href="/assets/js/12.57e510a0.js"><link rel="prefetch" href="/assets/js/13.6c53bfae.js"><link rel="prefetch" href="/assets/js/14.3cf9d9fc.js"><link rel="prefetch" href="/assets/js/15.0fc8a75c.js"><link rel="prefetch" href="/assets/js/16.c3659273.js"><link rel="prefetch" href="/assets/js/17.bab2e92a.js"><link rel="prefetch" href="/assets/js/18.5e9a7a92.js"><link rel="prefetch" href="/assets/js/19.4d3429e9.js"><link rel="prefetch" href="/assets/js/20.74acf710.js"><link rel="prefetch" href="/assets/js/21.06267600.js"><link rel="prefetch" href="/assets/js/22.7839cedf.js"><link rel="prefetch" href="/assets/js/23.3dce0edf.js"><link rel="prefetch" href="/assets/js/24.7fdebc9b.js"><link rel="prefetch" href="/assets/js/25.0a24ef84.js"><link rel="prefetch" href="/assets/js/26.617ba23a.js"><link rel="prefetch" href="/assets/js/27.c04c0547.js"><link rel="prefetch" href="/assets/js/28.0d4133a3.js"><link rel="prefetch" href="/assets/js/29.cbcccb09.js"><link rel="prefetch" href="/assets/js/3.2366cf4f.js"><link rel="prefetch" href="/assets/js/30.6d818151.js"><link rel="prefetch" href="/assets/js/31.bdec4218.js"><link rel="prefetch" href="/assets/js/33.dd58f41e.js"><link rel="prefetch" href="/assets/js/34.1bf13c14.js"><link rel="prefetch" href="/assets/js/35.54db212c.js"><link rel="prefetch" href="/assets/js/36.afda7bc0.js"><link rel="prefetch" href="/assets/js/37.ab829cda.js"><link rel="prefetch" href="/assets/js/38.daee3887.js"><link rel="prefetch" href="/assets/js/39.c2abbe56.js"><link rel="prefetch" href="/assets/js/4.0fc60aac.js"><link rel="prefetch" href="/assets/js/40.be866923.js"><link rel="prefetch" href="/assets/js/41.4f63824e.js"><link rel="prefetch" href="/assets/js/42.10ba89b1.js"><link rel="prefetch" href="/assets/js/43.0f723e0c.js"><link rel="prefetch" href="/assets/js/44.f6bc51da.js"><link rel="prefetch" href="/assets/js/45.dd0bbd15.js"><link rel="prefetch" href="/assets/js/46.f3da7dbb.js"><link rel="prefetch" href="/assets/js/47.e90ce123.js"><link rel="prefetch" href="/assets/js/48.f3be3a42.js"><link rel="prefetch" href="/assets/js/5.c8b01998.js"><link rel="prefetch" href="/assets/js/6.b63dc30b.js"><link rel="prefetch" href="/assets/js/7.ac8ece09.js"><link rel="prefetch" href="/assets/js/8.9fcf4328.js"><link rel="prefetch" href="/assets/js/9.e105d6a1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.495d9abf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">web-note</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/pages/" class="nav-link">
  笔记
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语言" class="dropdown-title"><span class="title">语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="语言" class="mobile-dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/language/chinese/" class="nav-link">
  中文
</a></li><li class="dropdown-item"><!----> <a href="/language/english/" class="nav-link">
  英文
</a></li></ul></div></div><div class="nav-item"><a href="https://www.baidu.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  去百度!
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/pages/" class="nav-link">
  笔记
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语言" class="dropdown-title"><span class="title">语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="语言" class="mobile-dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/language/chinese/" class="nav-link">
  中文
</a></li><li class="dropdown-item"><!----> <a href="/language/english/" class="nav-link">
  英文
</a></li></ul></div></div><div class="nav-item"><a href="https://www.baidu.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  去百度!
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/" class="sidebar-link">welcome</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>其他笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>安装环境</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工程化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>服务端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>框架</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/webnote/框架/react.html" class="active sidebar-link">React</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/webnote/框架/vue.html" class="sidebar-link">vue</a></li><li><a href="/webnote/框架/微信小程序.html" class="sidebar-link">微信小程序</a></li><li><a href="/webnote/框架/框架对比.html" class="sidebar-link">React Vue 小程序对比</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>面试</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>项目相关</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="react"><a href="#react" class="header-anchor">#</a> React</h3> <h5 id="cnpm-i-react-react-dom-s"><a href="#cnpm-i-react-react-dom-s" class="header-anchor">#</a> cnpm i react react-dom -S</h5> <h3 id="优点"><a href="#优点" class="header-anchor">#</a> 优点：</h3> <ul><li><p>jsx执行更快，js的优化</p></li> <li><p>更安全，可以及时发现错误，停止编译</p></li> <li><p>编写简单快速 ，vue除外</p></li></ul> <h3 id="理解"><a href="#理解" class="header-anchor">#</a> 理解</h3> <p>index.js是入口文件，引入App.js , 把App.js 这个地位最大的组件render到名为root 的div中</p> <p>App.js 定义路由什么的，还不知道干嘛的</p> <p>setState 异步更新状态，等别人执行完才能更新</p> <h4 id="相比vue"><a href="#相比vue" class="header-anchor">#</a> 相比vue</h4> <p>v-if v-for 都需要自己实现</p> <h4 id="原理-核心"><a href="#原理-核心" class="header-anchor">#</a> 原理-核心</h4> <div class="language-react extra-class"><pre class="language-text"><code>当行不需要括号，且只能有一个根标签
let element = (
  &lt;h2&gt;&lt;/h2&gt;
)
let root = document.getElementById(&quot;root&quot;)
// 渲染
ReactDOM.render(element,root)
</code></pre></div><h5 id="安装babel插件"><a href="#安装babel插件" class="header-anchor">#</a> 安装babel插件</h5> <div class="language-0 extra-class"><pre class="language-text"><code>cnpm i babel-core babel-loader babel-plugin-transform-runtime -D
cnpm i babel-preset-env	babel-preset-stage-0 -D
//识别转化jsx语法的包
cnpm i babel-preset-react -D
//配置webpack.config.js
module exports = {
  ...
  module：{//第三方模块
    rules:[//第三方匹配规则
    {test：/\.js|jsx$/,use:'babel-loader',exclude:/node_modules/}
    ]
  }
}
//添加.babelrc配文件
{
&quot;presets&quot;:[&quot;env&quot;,&quot;stage-0&quot;,&quot;react&quot;],
&quot;plugins&quot;:[&quot;transform-runtime&quot;]
}
</code></pre></div><h5 id="创建组件"><a href="#创建组件" class="header-anchor">#</a> 创建组件</h5> <div class="language- extra-class"><pre class="language-text"><code>//同级
function Component1(props){
	return (
	&lt;li key={props.index}&gt;&lt;/li&gt;
	)
}
//独立
class App extends Component {
  constructor(props) {
  super(props);this.state = {};}
  render() {
    return (&lt;div className=&quot;App&quot;&gt;&lt;/div&gt;);}
}
export default App;
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>import Hello from './components/Hello.jsx'//后缀名需要配置后才可以省略
</code></pre></div><h5 id="webpack-config-js配置省略文件名"><a href="#webpack-config-js配置省略文件名" class="header-anchor">#</a> webpack.config.js配置省略文件名</h5> <div class="language- extra-class"><pre class="language-text"><code>module。exports = {
  ...
  resolve:{
  extensions:['.js','.jsx','.json'],
  alias:{
    &quot;@&quot;: path.join(__dirname,'./src')
    }
  }
}
</code></pre></div><h5 id="class基础用法"><a href="#class基础用法" class="header-anchor">#</a> class基础用法</h5> <div class="language- extra-class"><pre class="language-text"><code>class Animal (){
  //构造器不写默认也有，就是空的而已
  //new的时候先执行构造器，new可以把里面的属性点出来
  constructor(name,age){
    this.name = name
    this.age = age
  }
  //静态属性(new 的点不出来)
  static info = 'eee'
}
const a1 = new Animal('大黄'，3)
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>npm install <span class="token operator">-</span>g create<span class="token operator">-</span>react<span class="token operator">-</span>app
create<span class="token operator">-</span>react<span class="token operator">-</span>app mydemo
<span class="token comment">// 	进入项目</span>
cd mydemo
<span class="token comment">//	运行项目</span>
npm start <span class="token operator">||</span> yarn start
<span class="token comment">//	生成项目</span>
npm run build <span class="token operator">||</span> yarn build
</code></pre></div><h3 id="create-react-app慢的解决方法"><a href="#create-react-app慢的解决方法" class="header-anchor">#</a> create-react-app慢的解决方法</h3> <div class="language- extra-class"><pre class="language-text"><code>npm config set registry https://registry.npm.taobao.org
-- 配置后可通过下面方式来验证是否成功
npm config get registry
-- 或npm info express
</code></pre></div><h3 id="创建组件src-components-home-js"><a href="#创建组件src-components-home-js" class="header-anchor">#</a> 创建组件src-components-Home.js</h3> <div class="language-react extra-class"><pre class="language-text"><code> // 相当于vue的data(){}
  constructor(props) {
    // props父子传值
    super(props); // 继承
    this.state = { name: &quot;Tom&quot;, age: 18 },
    this.fun2 = this.fun2.bind(this)
  },
  // 三种方法--this
  fun1(){方法里的this，不是外面那个this},
  fun2(){方法里的this，不是外面那个this},
  fun3 = () =&gt;{
  	this.setState({ })
  },  
  fun4=(str)=&gt;{
  	this.setState({ msg:str })
  }, 
  // 相当于vue的《template》
  render() 
    return 
      &lt;div&gt;
				&lt;button onClick={this.fun1.bind(this)}&gt;&lt;/button&gt;
				&lt;button onClick={this.fun2}&gt;&lt;/button&gt;
				&lt;button onClick={this.fun3}&gt;&lt;/button&gt;
  			// 箭头函数可写bind,如果是在遍历里面的话需要bind,因为this指向
				&lt;button onClick={this.fun4('zs')}&gt;&lt;/button&gt;
				&lt;button onClick={this.fun4.bind(this,'zs')}&gt;&lt;/button&gt;
      &lt;/div&gt;
</code></pre></div><h3 id="绑定属性"><a href="#绑定属性" class="header-anchor">#</a> 绑定属性</h3> <div class="language- extra-class"><pre class="language-text"><code>this.state = {
  style:{
    color:'red'
  }
}
return(
&lt;div style={{&quot;color&quot;:&quot;red&quot;}}&gt;&lt;/div&gt;
&lt;div style={this.state.style}&gt;&lt;/div&gt;
)
</code></pre></div><h3 id="img"><a href="#img" class="header-anchor">#</a> img</h3> <div class="language- extra-class"><pre class="language-text"><code>import logo from './...'
&lt;img src=&quot;http.....&quot;&gt;&lt;/img&gt;
&lt;img src={require('./...')}&gt;&lt;/img&gt;
&lt;img src={logo}&gt;&lt;/img&gt;
</code></pre></div><h3 id="遍历"><a href="#遍历" class="header-anchor">#</a> 遍历</h3> <div class="language-react extra-class"><pre class="language-text"><code>list=[{title:'11'},{title:'22'}]
{
  this.stata.list.map((v,i) =&gt;{
    return (&lt;li key={i}&gt;{v.title}&lt;/li&gt;)
  })
}
</code></pre></div><h3 id="标签传值"><a href="#标签传值" class="header-anchor">#</a> 标签传值</h3> <div class="language- extra-class"><pre class="language-text"><code>&lt;aid = &quot;666&quot;&gt;
function(e){
e.target.getAttribute('aid')
}
</code></pre></div><h3 id="ref"><a href="#ref" class="header-anchor">#</a> ref</h3> <div class="language- extra-class"><pre class="language-text"><code>&lt; ref=&quot;one&quot;&gt;
this.refs.one
</code></pre></div><h3 id="单向绑定"><a href="#单向绑定" class="header-anchor">#</a> 单向绑定</h3> <div class="language- extra-class"><pre class="language-text"><code>this.state = {}
&lt;input defaultValue={this.state.msg}&gt;&lt;/input&gt;
</code></pre></div><h3 id="双向数据绑定"><a href="#双向数据绑定" class="header-anchor">#</a> 双向数据绑定</h3> <div class="language-react extra-class"><pre class="language-text"><code>this.state = {}
inputChange=()=&gt;{}
&lt;input value={this.state.msg} onChange={this.inputChange}&gt;&lt;/input&gt;
</code></pre></div><h3 id="阻止form表单提交事件"><a href="#阻止form表单提交事件" class="header-anchor">#</a> 阻止form表单提交事件</h3> <div class="language-react extra-class"><pre class="language-text"><code>handleSubmit=(e)=&gt;{
  e.preventDefault();
}
&lt;form onSubmit={this.handleSubmit}&gt;
&lt;input type=&quot;text&quot;&gt;&lt;/input&gt;
&lt;input type=&quot;submit&quot; defaultValue=&quot;提交&quot;&gt;&lt;/input&gt;
&lt;/form&gt;
</code></pre></div><h3 id="生命周期"><a href="#生命周期" class="header-anchor">#</a> 生命周期</h3> <div class="language- extra-class"><pre class="language-text"><code>1触发构造函数
shouldComponentUpdate(){return true}
2页面将要加载(不用了)
componentWIllMount(){}
3页面加载时触发
componentDidMount(){}
4页面将销毁时   举例:提示你是否保存
componentWillUnmount() { }
</code></pre></div><h3 id="事件"><a href="#事件" class="header-anchor">#</a> 事件</h3> <h4 id="键盘事件"><a href="#键盘事件" class="header-anchor">#</a> 键盘事件</h4> <div class="language-react extra-class"><pre class="language-text"><code>&lt;onKeyUp={this.func} /&gt;
func(e){
  e.keyCode
  e.preventDefault()
}
传参
&lt;onKeyUp={function(e){this.func(&quot;参数&quot;,e,1,2,3)}.bind(this)} /&gt;  //es5
&lt;onKeyUp={(e)=&gt;this.func(&quot;参数&quot;,e)} /&gt;  //es6
func(msg,e,a,b,c){
  console.log(msg)
  console.log(e)
}
</code></pre></div><p>列表渲染</p> <p>for forEach map</p> <p>map会返回数组</p> <h3 id="传值"><a href="#传值" class="header-anchor">#</a> 传值</h3> <h4 id="标签传值-传方法-传自己-父-子"><a href="#标签传值-传方法-传自己-父-子" class="header-anchor">#</a> 标签传值 传方法  传自己 --父--&gt;子</h4> <div class="language- extra-class"><pre class="language-text"><code>父:
&lt; xxx={this.state.xxx}
--fun1={this.fun1} 
--news(组件名)={this}
/&gt;
子:
--{this.props.xxx}
--{this.props.fun1}
--{this.props.news.funxx}
--{this.props.news.funxx.bind(this,&quot;传值&quot;)}
</code></pre></div><h4 id="标签设值"><a href="#标签设值" class="header-anchor">#</a> 标签设值</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//react</span>
value<span class="token operator">=</span><span class="token string">&quot;普通文本&quot;</span>
value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>xxx<span class="token punctuation">}</span>
<span class="token comment">//Vue</span>
value<span class="token operator">=</span><span class="token string">&quot;普通文本&quot;</span>
<span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">&quot;条件。。。&quot;</span>
</code></pre></div><h4 id="父调用子的方法"><a href="#父调用子的方法" class="header-anchor">#</a> 父调用子的方法</h4> <div class="language- extra-class"><pre class="language-text"><code>父:
&lt; ref=&quot;footer&quot;&gt;
this.refs.footer.fun()
</code></pre></div><h4 id="defaultprops-proptypes"><a href="#defaultprops-proptypes" class="header-anchor">#</a> defaultProps---PropTypes</h4> <div class="language-react extra-class"><pre class="language-text"><code>父组件有传入props的话,用父组件的,没有就用默认参数
&lt;h2&gt;--{this.props.title}--&lt;/h2&gt;
Son.defaultProps={
	title:&quot;标题&quot;
}
//porpsTypes验证合法性(子组件使用)
import PropTypes from 'prop-types'
Son.propsTypes = {
  title:PropTypes.string // number
}
</code></pre></div><h4 id="路由传值"><a href="#路由传值" class="header-anchor">#</a> 路由传值</h4> <h5 id="动态路由传值-match-params"><a href="#动态路由传值-match-params" class="header-anchor">#</a> 动态路由传值---match.params</h5> <div class="language-react extra-class"><pre class="language-text"><code>App.js配置
&lt;Route path='/content:aid' component={Content}&gt;&lt;/Route&gt;
父组件里
&lt;link to={`/content/${value.aid}`} &gt;&lt;/link&gt;
子组件里--Content组件里获取aid
componentDidMount(){
  this.props.match.params.aid
}
</code></pre></div><h5 id="get传值-location-search"><a href="#get传值-location-search" class="header-anchor">#</a> get传值----location.search</h5> <div class="language-react extra-class"><pre class="language-text"><code>App.js配置
&lt;Route path='/content' component={Content}&gt;&lt;/Route&gt;
父组件里
&lt;link to={`/content/?aid=${value.aid}`}&gt;&lt;/link&gt;
子组件里--Content组件里获取aid
componentDidMount(){
  this.props.location.search.aid   // ?aid=xxx需要解析
}
cnpm i url -S
import url from 'url'
var aid = url.parse( this.props.location.search.aid,true).query.aid
</code></pre></div><h3 id="路由"><a href="#路由" class="header-anchor">#</a> 路由</h3> <h4 id="路由配置"><a href="#路由配置" class="header-anchor">#</a> 路由配置</h4> <p>Router下需要一个div包裹</p> <table><thead><tr><th>exact</th> <th style="text-align:left;">精确匹配</th></tr></thead> <tbody><tr><td>replace</td> <td style="text-align:left;">替换当前路由，历史不记录被替换的</td></tr> <tr><td>Redirect</td> <td style="text-align:left;">重定向组件</td></tr> <tr><td>redirect</td> <td style="text-align:left;">改路由</td></tr> <tr><td>Switch</td> <td style="text-align:left;">组件 只匹配一个路由</td></tr></tbody></table> <div class="language-react extra-class"><pre class="language-text"><code>import { BrowserRouter as Router, Route, Link } from &quot;react-router-dom&quot;;
&lt;Router basename=&quot;/base&quot;&gt;
  &lt;div&gt;
  &lt;Link to=&quot;/&quot;&gt;首页&lt;/Link&gt;
    &lt;div&gt;
      &lt;Route path='/shop/add' component={ShopAdd}&gt;&lt;/Route&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/Router&gt;
</code></pre></div><h4 id="嵌套路由"><a href="#嵌套路由" class="header-anchor">#</a> 嵌套路由</h4> <p>遍历时把自己小弟routes(children)传下去</p> <div class="language-react extra-class"><pre class="language-text"><code>return &lt;Route key={key} exact path={route.path} render={props =&gt; &lt;route.component {...props} routes={route.routes} /&gt;}
 /&gt;
</code></pre></div><h4 id="路由跳转"><a href="#路由跳转" class="header-anchor">#</a> 路由跳转</h4> <div class="language- extra-class"><pre class="language-text"><code>this.props.history.replace('/')
&lt;Redirect to='/login' /&gt;
</code></pre></div><h3 id="数据请求"><a href="#数据请求" class="header-anchor">#</a> 数据请求</h3> <h5 id="axios不支持jsonp-需要用fetch"><a href="#axios不支持jsonp-需要用fetch" class="header-anchor">#</a> axios不支持jsonp,需要用fetch</h5> <div class="language- extra-class"><pre class="language-text"><code>fetch('/users.json')
	//先转换
  .then(function(response) {
    return response.json()
  })
  //成功回调
  .then(function(json) {
    console.log('parsed json', json)
  })
  //失败回调
  .catch(function(ex) {
    console.log('parsing failed', ex)
  })
</code></pre></div><h3 id="webpack配置"><a href="#webpack配置" class="header-anchor">#</a> webpack配置</h3> <p>方法1:</p> <p>点开package.json文件，可看到配置的命令是以 &quot;react-scripts ***&quot; 来执行，所以打开node_modules文件夹，找到react-scripts文件夹进去， config目录即是你需要找的webpack的配置文件，然后就自己去修改配置就好</p> <p>方法二:</p> <p>使用 create-react-app 创建的项目，默认情况下是看不到 webpack 相关的配置文件，我们需要给它暴露出来，使用下面命令即可</p> <div class="language- extra-class"><pre class="language-text"><code>npm run eject
</code></pre></div><h3 id="报错"><a href="#报错" class="header-anchor">#</a> 报错：</h3> <h4 id="operation-not-permitted"><a href="#operation-not-permitted" class="header-anchor">#</a> operation not permitted</h4> <p>解决：以管理员打开</p> <h4 id="the-path-argument-must-be-of-type-string-received-undefined"><a href="#the-path-argument-must-be-of-type-string-received-undefined" class="header-anchor">#</a> The &quot;path&quot; argument must be of type string. Received undefined</h4> <p>方法一:   (我试了,不行,他是npx报的错,应该不适用)</p> <p>https://www.jianshu.com/p/460303a6ef38</p> <p>博客原文：https://blog.yinaoxiong.cn/2018/08/19/fix-npx-erro.html</p> <p>在使用Windows上使用较老版本的nodejs，如何我使用的v8.9其自带的npx的版本为9.7，在Windows上使用会存在：“Path must be a string. Received undefined”的错误。通过 GitHub 上的 issue 可以知道改问题已经在最新版的npx中解决了，可以通过npm手动升级到最新版解决。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">npm</span> i -g npx
</code></pre></div><p>但是运行npx -v后我们发现还是老版本的npx在运行新下载的npx并没有生效，这就是Windows环境变量的锅了。</p> <h5 id="原因"><a href="#原因" class="header-anchor">#</a> 原因:</h5> <p>安装node时node的安装目录是在系统变量的path中，而node全局安装包的目录是在用户的path中，系统查询可执行文件的属性是  **先查询系统path变量，然后再查询用户path变量。**所以node安装目录下的npx就覆盖了node全局安装目录下的npx。</p> <h5 id="解决方法是"><a href="#解决方法是" class="header-anchor">#</a> 解决方法是:</h5> <p>把用户变量下path中node全局安装的路径复制到系统变量的path中。（如果自己没有修改过node全局安装目录的话这个路径一般是：&quot;C:\Users{your_user_name}\AppData\Roaming\npm&quot;),</p> <p>注意<strong>一定要把这个路径放在node安装目录前面</strong>，因为查找是从上到下查找的。之后就可以开心的使用npx了。</p> <h5 id="另一个办法-好像也不行"><a href="#另一个办法-好像也不行" class="header-anchor">#</a> 另一个办法: (好像也不行)</h5> <p>https://www.e-learn.cn/content/qita/2012187</p> <p>//webpack.config.js</p> <div class="language- extra-class"><pre class="language-text"><code>plugins: [
    new HtmlWebpackPlugin({
        title: 'use plugin',
        filename: 'index.html'
    })
]
</code></pre></div><p>方法三:</p> <p>重新create-react-app 一个新项目, 搬运src文件夹和package.json</p> <h4 id="ant-按需引入-报错"><a href="#ant-按需引入-报错" class="header-anchor">#</a> ant 按需引入 报错</h4> <p>降级处理</p> <p>cnpm i react-app-rewired@2.0.2-next.0 --save-dev</p> <h3 id="按需打包antd-的css"><a href="#按需打包antd-的css" class="header-anchor">#</a> 按需打包antd 的css</h3> <p>https://ant-design.gitee.io/docs/react/use-with-create-react-app-cn</p> <p>下载依赖包</p> <div class="language- extra-class"><pre class="language-text"><code>yarn add react-app-rewired customize-cra babel-plugin-import
</code></pre></div><p>config-overrides.js</p> <div class="language- extra-class"><pre class="language-text"><code>const { override, fixBabelImports, addLessLoader } = require('customize-cra');
module.exports = override(
  fixBabelImports('import', {
    libraryName: 'antd',
    libraryDirectory: 'es',
    style: true,
  }),
  addLessLoader({
    javascriptEnabled: true,
    modifyVars: { '@primary-color': '#1DA57A' },
  }),
);
</code></pre></div><p>更改 package.json</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token comment">/* package.json */</span>
<span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
-   <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;react-scripts start&quot;</span><span class="token punctuation">,</span>
+   <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;react-app-rewired start&quot;</span><span class="token punctuation">,</span>
-   <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;react-scripts build&quot;</span><span class="token punctuation">,</span>
+   <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;react-app-rewired build&quot;</span><span class="token punctuation">,</span>
-   <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;react-scripts test&quot;</span><span class="token punctuation">,</span>
+   <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;react-app-rewired test&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="使用pm2管理应用"><a href="#使用pm2管理应用" class="header-anchor">#</a> 使用pm2管理应用</h3> <p>安装命令：npm i pm2 -g
启动项目：pm2 start app.js --name 自定义名称
查看列表：pm2 ls
重启项目：pm2 restart 自定义名称
停止项目：pm2 stop 自定义名称
删除项目：pm2 delete 自定义名称</p> <h3 id="解决跨越"><a href="#解决跨越" class="header-anchor">#</a> 解决跨越</h3> <p>package.json里加个代理人,适用于开发模式</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;proxy&quot;:&quot;http://localhost:5000&quot;
</code></pre></div><p>baseURL那边也要写：<code>baseURL = &quot;&quot;</code></p> <div class="language- extra-class"><pre class="language-text"><code>//解决ajax跨域问题
  res.append(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;)
  res.append(&quot;Access-Control-Allow-content-type&quot;, &quot;*&quot;)
</code></pre></div><h3 id="antd开发"><a href="#antd开发" class="header-anchor">#</a> antd开发</h3> <h4 id="form"><a href="#form" class="header-anchor">#</a> Form</h4> <p>getFieldDecorator修饰验证</p> <div class="language- extra-class"><pre class="language-text"><code>{
getFieldDecorator('password', {
rules: [{ validator: this.validatePwd }],})
(&lt;Input
  prefix={&lt;Icon type=&quot;lock&quot; style={{ color: 'rgba(0,0,0,.25)' }} /&gt;}
  type=&quot;password&quot;
  placeholder=&quot;密码&quot;
/&gt;)
}
</code></pre></div><h5 id="验证规则rules写法"><a href="#验证规则rules写法" class="header-anchor">#</a> 验证规则rules写法</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code>一
rules<span class="token operator">:</span> <span class="token punctuation">[</span>
<span class="token punctuation">{</span> required<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> whitespace<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> message<span class="token operator">:</span> <span class="token string">'请输入密码!'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span> min<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> message<span class="token operator">:</span> <span class="token string">'最少4位!'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span> max<span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> message<span class="token operator">:</span> <span class="token string">'最多12位!'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span> pattern<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^[a-zA-Z0-9_]+$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> message<span class="token operator">:</span> <span class="token string">'用户名必须是英文字母、数字或下划线组成!'</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
二
rules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> validator<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>validatePwd <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token comment">// 自定义验证规则</span>
<span class="token function-variable function">validatePwd</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">rule<span class="token punctuation">,</span> value<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'请输入密码'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'密码长度必须大于6位'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'密码长度不能大于12位'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^[a-zA-Z0-9_]+$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'密码必须是英文字母、数字或下划线组成'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre></div><h5 id="暴露组件需要包装-包装后组件新增location-match-history属性"><a href="#暴露组件需要包装-包装后组件新增location-match-history属性" class="header-anchor">#</a> 暴露组件需要包装，包装后组件新增location match history属性</h5> <div class="language- extra-class"><pre class="language-text"><code>不暴露原来组件Login，暴露新输出的的
// 包装Login 输入特定的值,输出一个强大的对象属性-from
const wrapLogin = Form.create()(Login)
export default wrapLogin;
</code></pre></div><h3 id="react-插槽"><a href="#react-插槽" class="header-anchor">#</a> React 插槽</h3> <p>给引用的子组件里面写标签，data-positon=&quot;header&quot;</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;Children&gt;
&lt;div data-positon=&quot;header&quot;&gt;&lt;/div&gt;
&lt;div data-positon=&quot;content&quot;&gt;&lt;/div&gt;
&lt;div data-positon=&quot;footer&quot;&gt;&lt;/div&gt;
&lt;/Children&gt;
</code></pre></div><p>子组件里面可以通过foreach判断条件添加对应插槽</p> <div class="language-react extra-class"><pre class="language-text"><code>this.props.children.forEach((v,i)=&gt;{
if(item.props['data-positon'] === header) {
headerDom = item 
}else if(item.props['data-positon'] === content) {
contentDom = item 
}else if(item.props['data-positon'] === footer) {
footerDom = item 
}
})
子组件里面内容
&lt;div&gt;
  {headerDom}
  {headerDom}
  {headerDom}
&lt;/div
</code></pre></div><h3 id="redux-数据管理"><a href="#redux-数据管理" class="header-anchor">#</a> redux--数据管理</h3> <table><thead><tr><th>Store</th> <th>数据仓库</th></tr></thead> <tbody><tr><td>State</td> <td>数据</td></tr> <tr><td>Action</td> <td>动作 触发改变的方法</td></tr> <tr><td>Dispatch</td> <td>将动作触发成方法</td></tr> <tr><td>Reducer</td> <td>函数 获取动作 改变数据 生成新的state</td></tr></tbody></table> <div class="language-react extra-class"><pre class="language-text"><code>import Redux,{createStore} from 'redux'
// 创建仓库
const store = createStore(reducer) 
// 通过动作创建新的state
cosnt reducer=function(state={num:0},action){
  switch(action.type){
    case &quot;add&quot;:state.num ++;break;
    case &quot;decrement&quot;:state.num --;break;
    default：return
  }
	return {...state}
}
function add(){
  // 调用仓库的dispatch方法修改数据
	store.dispatch({type:&quot;add&quot;})
}
function decrement(){
  // 调用仓库的dispatch方法修改数据
	store.dispatch({type:&quot;decrement&quot;})
}
// 监听修改 重新渲染
store.subscribe(()=&gt;{
  ReactDOM.render(&lt;Counter&gt;&lt;/Counter/&gt;,document.getElementById(&quot;root&quot;))
})
// 数据获取
{store.getState()}
</code></pre></div><h4 id="react-redux"><a href="#react-redux" class="header-anchor">#</a> react-redux</h4> <div class="language-react extra-class"><pre class="language-text"><code>import {Povider，connect} from 'react-redux'
class Counter extends React.Component{
	reder(){
		const value = this.props.value;
		const onAddClick = this.props.onAddClick
	}
}
const
 addAction = { type: &quot;add&quot;}
 function reducer (state={num:0},action){
 switch(action.type){
    case &quot;add&quot;:state.num ++;break;
    default：return
  }
	return {...state}
 }
const store = createStore(reducer)
/ 修改state里的方法，映射到props
function mapDispatchToProps(dispatch){
  return {
    onAddClick:()={dispatch(addAction)}
}
</code></pre></div><h3 id="echart不更新"><a href="#echart不更新" class="header-anchor">#</a> Echart不更新</h3> <p>props和state最好别联系在一起，state的更新麻烦，因为<code>componentDidMount</code>方法只会执行一次，render时state不会更新，setState刷新的关键：</p> <ol><li>setState不会立刻改变React组件中state的值；</li> <li>setState通过引发一次组件的更新过程来引发重新绘制；</li> <li>多次setState函数调用产生的效果会合并。</li></ol></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/29/2022, 7:51:07 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/webnote/服务端/数据库.html" class="prev">
        数据库
      </a></span> <span class="next"><a href="/webnote/框架/vue.html">
        vue
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.7e40d91d.js" defer></script><script src="/assets/js/2.74dbbd17.js" defer></script><script src="/assets/js/32.557433ae.js" defer></script>
  </body>
</html>
